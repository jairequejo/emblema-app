<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0">
  <title>JR Stars | Portal del Atleta</title>
  <meta name="description" content="Consulta el estatus de tu atleta en JR Stars Academia Deportiva, Cajamarca.">
  <link rel="icon" href="/static/img/logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">

  <link
    href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Barlow+Condensed:wght@400;600;700;800&family=Barlow:wght@400;500&display=swap"
    rel="stylesheet">
  <style>
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent
    }

    html {
      scroll-behavior: smooth
    }

    :root {
      --black: #0a0a0a;
      --dark: #111;
      --card: #181818;
      --border: rgba(255, 255, 255, .07);
      --red: #CC1616;
      --red2: #e60000;
      --red-gl: rgba(204, 22, 22, .15);
      --gold: #D4A017;
      --gold2: #F5C842;
      --gold-gl: rgba(212, 160, 23, .14);
      --neon: #ccff00;
      --green: #25D366;
      --white: #F0EDE8;
      --gray: #888;
      --gray2: #444;
      --ff-h: 'Bebas Neue', sans-serif;
      --ff-c: 'Barlow Condensed', sans-serif;
      --ff-b: 'Barlow', sans-serif;
      --clip: polygon(10px 0%, 100% 0%, calc(100% - 10px) 100%, 0% 100%);
    }

    body {
      font-family: var(--ff-b);
      background: var(--black);
      color: var(--white);
      overflow-x: hidden;
      min-height: 100dvh
    }

    body::after {
      content: '';
      position: fixed;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
      pointer-events: none;
      z-index: 9999;
      opacity: .3
    }

    .hidden {
      display: none !important
    }

    /* TOPBAR */
    .topbar {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: .6rem;
      padding: .7rem 1.5rem;
      background: rgba(10, 10, 10, .96);
      border-bottom: 1px solid var(--border);
      backdrop-filter: blur(8px);
      position: sticky;
      top: 0;
      z-index: 50
    }

    .tl {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      border: 2px solid var(--gold);
      overflow: hidden;
      flex-shrink: 0;
      background: var(--dark)
    }

    .tl img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block
    }

    .tn {
      font-family: var(--ff-h);
      font-size: 1.8rem;
      letter-spacing: .1em;
      color: var(--white)
    }

    .tn span {
      color: var(--gold)
    }

    /* PANEL 1 ‚Äî B√öSQUEDA */
    #p1 {
      min-height: calc(100dvh - 50px);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2.5rem 1.5rem 4rem;
      text-align: center;
      gap: 1.4rem
    }

    .hero-logo {
      width: 120px;
      height: 120px;
      object-fit: contain;
      filter: drop-shadow(0 0 18px rgba(204, 22, 22, .5));
      animation: float 4s ease-in-out infinite
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0)
      }

      50% {
        transform: translateY(-8px)
      }
    }

    .divider-rg {
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, var(--red), var(--gold))
    }

    .hero-h {
      font-family: var(--ff-h);
      font-size: clamp(2.4rem, 8vw, 4.8rem);
      line-height: .92;
      letter-spacing: .05em
    }

    .hero-h span {
      color: var(--gold);
      display: block
    }

    .hero-sub {
      font-family: var(--ff-c);
      font-size: .78rem;
      letter-spacing: .35em;
      text-transform: uppercase;
      color: var(--gray)
    }

    .sbox {
      width: 100%;
      max-width: 400px;
      display: flex;
      flex-direction: column;
      gap: .85rem
    }

    .dni-in {
      font-family: var(--ff-h);
      font-size: 2rem;
      letter-spacing: 7px;
      text-align: center;
      background: var(--card);
      color: var(--white);
      border: 1px solid var(--border);
      border-bottom: 3px solid var(--gold);
      padding: .85rem 1rem;
      outline: none;
      width: 100%;
      transition: border-color .2s, box-shadow .2s
    }

    .dni-in:focus {
      box-shadow: 0 4px 20px rgba(212, 160, 23, .14)
    }

    .dni-in::placeholder {
      color: var(--gray2);
      font-size: 1.2rem;
      letter-spacing: 3px
    }

    .btn-cta {
      font-family: var(--ff-c);
      font-weight: 800;
      font-size: 1.3rem;
      letter-spacing: .14em;
      text-transform: uppercase;
      background: linear-gradient(135deg, var(--red), #7a0000);
      color: var(--white);
      border: none;
      cursor: pointer;
      padding: .95rem;
      width: 100%;
      clip-path: var(--clip);
      transition: filter .2s, transform .15s
    }

    .btn-cta:hover {
      filter: brightness(1.12)
    }

    .btn-cta:active {
      transform: scale(.98)
    }

    /* Loader */
    .ld-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: .8rem;
      font-family: var(--ff-c);
      letter-spacing: .18em;
      color: var(--gray)
    }

    .sp {
      width: 20px;
      height: 20px;
      border: 3px solid var(--dark);
      border-top-color: var(--gold);
      border-radius: 50%;
      animation: spin .7s linear infinite;
      flex-shrink: 0
    }

    @keyframes spin {
      to {
        transform: rotate(360deg)
      }
    }

    /* Cisne Negro */
    .err-card {
      width: 100%;
      max-width: 400px;
      background: var(--red-gl);
      border: 1px solid rgba(204, 22, 22, .5);
      padding: 1.4rem;
      animation: shake .4s
    }

    .err-tag {
      font-family: var(--ff-c);
      font-size: .68rem;
      letter-spacing: .35em;
      text-transform: uppercase;
      color: var(--red);
      margin-bottom: .3rem
    }

    .err-h {
      font-family: var(--ff-h);
      font-size: clamp(1.9rem, 6vw, 2.8rem);
      line-height: .93;
      margin-bottom: .6rem
    }

    .err-p {
      font-size: .87rem;
      color: #ccc;
      line-height: 1.5;
      margin-bottom: 1.2rem
    }

    @keyframes shake {

      0%,
      100% {
        transform: translateX(0)
      }

      20%,
      60% {
        transform: translateX(-5px)
      }

      40%,
      80% {
        transform: translateX(5px)
      }
    }

    .btn-wa {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: .5rem;
      width: 100%;
      padding: .88rem;
      background: var(--green);
      color: #000;
      font-family: var(--ff-c);
      font-weight: 800;
      font-size: 1.15rem;
      letter-spacing: .1em;
      text-transform: uppercase;
      text-decoration: none;
      clip-path: var(--clip);
      transition: filter .2s
    }

    .btn-wa:hover {
      filter: brightness(1.08)
    }

    /* PANEL 2 ‚Äî FICHA FUT */
    #p2 {
      padding: 0 1.2rem 2rem;
      max-width: 540px;
      margin: 0 auto;
      width: 100%
    }

    .back-btn {
      font-family: var(--ff-c);
      font-size: .9rem;
      font-weight: 700;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: var(--gray);
      background: none;
      border: none;
      cursor: pointer;
      padding: .8rem 0;
      display: flex;
      align-items: center;
      gap: .3rem;
      transition: color .15s
    }

    .back-btn:hover {
      color: var(--white)
    }

    /* Glassmorphism card */
    .fut-card {
      border-radius: 3px;
      overflow: hidden;
      position: relative;
      background: rgba(20, 20, 20, .78);
      backdrop-filter: blur(12px) saturate(1.3);
      -webkit-backdrop-filter: blur(12px) saturate(1.3);
      border: 1px solid rgba(255, 255, 255, .08);
      box-shadow: 0 8px 32px rgba(0, 0, 0, .65);
      animation: cardIn .4s cubic-bezier(.22, 1, .36, 1)
    }

    @keyframes cardIn {
      from {
        opacity: 0;
        transform: translateY(20px) scale(.97)
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1)
      }
    }

    .card-stripe {
      height: 4px;
      background: linear-gradient(90deg, var(--red), var(--gold))
    }

    .fut-card.ok {
      box-shadow: 0 0 0 1px rgba(212, 160, 23, .45), 0 16px 40px rgba(212, 160, 23, .12)
    }

    .fut-card.ok .card-stripe {
      background: linear-gradient(90deg, var(--gold), var(--gold2), var(--gold));
      background-size: 200%;
      animation: shimmer 2.5s linear infinite
    }

    @keyframes shimmer {
      0% {
        background-position: 0%
      }

      100% {
        background-position: 200%
      }
    }

    .c-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1.2rem;
      border-bottom: 1px solid var(--border)
    }

    .avatar {
      width: 68px;
      height: 68px;
      border-radius: 50%;
      border: 2.5px solid var(--gold);
      background: var(--dark);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: var(--ff-h);
      font-size: 2rem;
      color: var(--gold);
      overflow: hidden;
      flex-shrink: 0
    }

    .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover
    }

    .c-name {
      font-family: var(--ff-h);
      font-size: clamp(1.5rem, 5vw, 2.2rem);
      color: var(--gold);
      line-height: 1;
      letter-spacing: .04em
    }

    .c-cat {
      font-family: var(--ff-c);
      font-size: .75rem;
      letter-spacing: .22em;
      text-transform: uppercase;
      color: var(--gray);
      margin-top: .2rem
    }

    /* Racha */
    .racha-blk {
      padding: 1.3rem 1.2rem;
      border-bottom: 1px solid var(--border);
      text-align: center
    }

    .racha-tag {
      font-family: var(--ff-c);
      font-size: .68rem;
      letter-spacing: .32em;
      text-transform: uppercase;
      color: var(--gray);
      display: block;
      margin-bottom: .4rem
    }

    .racha-num {
      font-family: var(--ff-h);
      font-size: clamp(2.4rem, 8vw, 3.8rem);
      color: var(--white);
      letter-spacing: .04em;
      text-shadow: 0 0 18px rgba(255, 87, 34, .4);
      line-height: 1
    }

    .fire {
      color: #ff5722
    }

    /* Bio actual */
    .bio-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      border-bottom: 1px solid var(--border)
    }

    .bio-cell {
      padding: .9rem 1.2rem;
      text-align: center
    }

    .bio-cell+.bio-cell {
      border-left: 1px solid var(--border)
    }

    .bio-val {
      font-family: var(--ff-h);
      font-size: 1.8rem;
      color: var(--white);
      line-height: 1
    }

    .bio-delta {
      font-size: .7rem;
      color: #2ecc71;
      margin-left: .25rem;
      font-family: var(--ff-c)
    }

    .bio-label {
      font-family: var(--ff-c);
      font-size: .7rem;
      letter-spacing: .2em;
      text-transform: uppercase;
      color: var(--gray);
      margin-top: .2rem
    }

    /* Historial biom√©trico */
    .bio-hist {
      padding: .95rem 1.2rem;
      border-bottom: 1px solid var(--border)
    }

    .hist-title {
      font-family: var(--ff-c);
      font-size: .68rem;
      letter-spacing: .3em;
      text-transform: uppercase;
      color: var(--gold);
      margin-bottom: .65rem
    }

    .hist-table {
      width: 100%;
      border-collapse: collapse
    }

    .hist-table th {
      font-family: var(--ff-c);
      font-size: .7rem;
      letter-spacing: .15em;
      text-transform: uppercase;
      color: var(--gray);
      padding: .3rem .5rem;
      text-align: left;
      border-bottom: 1px solid var(--border)
    }

    .hist-table td {
      font-family: var(--ff-c);
      font-size: .9rem;
      font-weight: 600;
      padding: .38rem .5rem;
      border-bottom: 1px solid rgba(255, 255, 255, .04);
      color: var(--white)
    }

    .hist-table tr:last-child td {
      border-bottom: none
    }

    .hist-table td.fecha {
      color: var(--gray);
      font-size: .82rem
    }

    /* Radar pr√≥ximamente */
    .radar-blk {
      padding: 1rem 1.2rem;
      border-bottom: 1px solid var(--border);
      background: rgba(0, 0, 0, .22);
      display: flex;
      align-items: center;
      gap: .9rem
    }

    .radar-hex {
      width: 44px;
      height: 44px;
      flex-shrink: 0;
      opacity: .25;
      background: conic-gradient(from 0deg, var(--gray2), var(--gray) 60deg, var(--gray2));
      clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)
    }

    .radar-txt {
      font-family: var(--ff-c);
      font-size: .83rem;
      color: var(--gray);
      line-height: 1.4
    }

    .radar-txt strong {
      color: var(--neon);
      font-size: .76rem;
      display: block;
      margin-bottom: .1rem;
      letter-spacing: .2em
    }

    /* Presumir */
    .btn-presumir {
      display: block;
      width: 100%;
      padding: .95rem;
      background: linear-gradient(135deg, #1a7a3a, var(--green));
      color: #000;
      font-family: var(--ff-h);
      font-size: 1.5rem;
      letter-spacing: .08em;
      text-align: center;
      text-decoration: none;
      transition: filter .2s
    }

    .btn-presumir:hover {
      filter: brightness(1.08)
    }

    /* DEUDA */
    .fut-card.deuda {
      border-color: rgba(204, 22, 22, .4)
    }

    .fut-card.deuda .c-header {
      filter: grayscale(90%);
      opacity: .55
    }

    .deuda-overlay {
      padding: 1.8rem 1.2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: .7rem;
      text-align: center;
      background: rgba(5, 5, 5, .9)
    }

    .lock-ico {
      font-size: 3.5rem;
      color: var(--red2)
    }

    .deuda-h {
      font-family: var(--ff-h);
      font-size: clamp(1.6rem, 5vw, 2.4rem);
      line-height: 1
    }

    .deuda-sub {
      font-family: var(--ff-c);
      font-size: .85rem;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: var(--red)
    }

    .deuda-desc {
      font-size: .82rem;
      color: #aaa;
      max-width: 260px;
      line-height: 1.5
    }

    .btn-pagar {
      font-family: var(--ff-c);
      font-weight: 800;
      font-size: 1.1rem;
      letter-spacing: .1em;
      text-transform: uppercase;
      background: linear-gradient(135deg, var(--red), #6b0000);
      color: var(--white);
      border: none;
      cursor: pointer;
      padding: .85rem 1.5rem;
      clip-path: var(--clip);
      width: 100%;
      max-width: 280px;
      transition: filter .2s;
      margin-top: .3rem
    }

    .btn-pagar:hover {
      filter: brightness(1.15)
    }

    /* PANEL 3 ‚Äî ECOSISTEMA */
    #p3 {
      max-width: 540px;
      margin: 0 auto;
      padding: 0 1.2rem 5rem
    }

    .eco-tag {
      font-family: var(--ff-c);
      font-size: .68rem;
      letter-spacing: .35em;
      text-transform: uppercase;
      color: var(--red);
      display: block;
      margin-bottom: .25rem
    }

    .eco-h {
      font-family: var(--ff-h);
      font-size: clamp(1.9rem, 6vw, 2.8rem);
      letter-spacing: .05em;
      line-height: 1;
      margin-bottom: 1rem
    }

    .eco-h span {
      color: var(--gold)
    }

    .eco-sec {
      margin-bottom: 2rem
    }

    /* Kiosko */
    .k-card {
      background: var(--card);
      border: 1px solid var(--border);
      overflow: hidden
    }

    .k-energy {
      padding: .85rem 1.2rem;
      border-bottom: 1px solid var(--border);
      background: rgba(0, 0, 0, .3)
    }

    .k-energy-lbl {
      font-family: var(--ff-c);
      font-size: .8rem;
      letter-spacing: .1em;
      color: #e67e22;
      margin-bottom: .45rem;
      display: flex;
      justify-content: space-between
    }

    .k-bar {
      height: 7px;
      background: var(--dark);
      border-radius: 4px;
      overflow: hidden
    }

    .k-fill {
      height: 100%;
      width: 25%;
      background: linear-gradient(90deg, #e67e22, #e74c3c);
      border-radius: 4px;
      animation: pulse-bar 2.2s ease-in-out infinite
    }

    @keyframes pulse-bar {

      0%,
      100% {
        opacity: 1
      }

      50% {
        opacity: .55
      }
    }

    .k-body {
      padding: 1.1rem 1.2rem
    }

    .k-lbl {
      font-family: var(--ff-c);
      font-size: .7rem;
      letter-spacing: .3em;
      text-transform: uppercase;
      color: var(--gray);
      display: block;
      margin-bottom: .15rem
    }

    .k-bal {
      font-family: var(--ff-h);
      font-size: 2rem;
      color: var(--gold);
      margin-bottom: .7rem
    }

    .k-desc {
      font-size: .83rem;
      color: var(--gray);
      line-height: 1.5;
      margin-bottom: 1.1rem
    }

    .btn-rec {
      display: block;
      width: 100%;
      padding: .85rem;
      font-family: var(--ff-c);
      font-weight: 800;
      font-size: 1.15rem;
      letter-spacing: .12em;
      text-transform: uppercase;
      background: linear-gradient(135deg, var(--gold), var(--gold2));
      color: #000;
      border: none;
      cursor: pointer;
      clip-path: var(--clip);
      text-align: center;
      text-decoration: none;
      transition: filter .2s
    }

    .btn-rec:hover {
      filter: brightness(1.1)
    }

    /* Ranking */
    .rk-card {
      background: var(--card);
      border: 1px solid var(--border);
      overflow: hidden
    }

    .rk-head {
      padding: .9rem 1.2rem;
      border-bottom: 1px solid var(--border);
      background: rgba(0, 0, 0, .3)
    }

    .rk-title {
      font-family: var(--ff-h);
      font-size: 1.8rem;
      color: var(--gold);
      line-height: 1
    }

    .rk-sub {
      font-family: var(--ff-c);
      font-size: .75rem;
      letter-spacing: .1em;
      color: var(--gray)
    }

    .rk-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: .72rem 1.2rem;
      border-bottom: 1px solid var(--border);
      transition: background .15s
    }

    .rk-item:last-child {
      border-bottom: none
    }

    .rk-item:hover {
      background: rgba(255, 255, 255, .03)
    }

    .rk-item.first {
      background: linear-gradient(90deg, rgba(212, 160, 23, .1), transparent)
    }

    .rk-pos {
      font-family: var(--ff-h);
      font-size: 1.5rem;
      color: var(--gray);
      width: 26px;
      text-align: center;
      flex-shrink: 0
    }

    .rk-item.first .rk-pos {
      color: var(--gold);
      font-size: 2rem
    }

    .rk-name {
      flex: 1;
      font-family: var(--ff-c);
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: .05em
    }

    .rk-score {
      font-family: var(--ff-h);
      font-size: 1.3rem;
      color: #ff5722
    }

    .rk-empty {
      padding: 1.2rem;
      text-align: center;
      font-family: var(--ff-c);
      color: var(--gray)
    }

    /* Footer */
    .ft-block {
      border-top: 1px solid var(--border);
      margin-top: 2rem;
      padding: 1.4rem 0;
      text-align: center
    }

    .ft-links {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: .5rem 1.2rem;
      margin-bottom: .7rem
    }

    .ft-links a {
      color: var(--gold);
      text-decoration: none;
      font-family: var(--ff-c);
      font-size: .84rem;
      letter-spacing: .1em
    }

    .ft-links a:hover {
      color: var(--white)
    }

    .ft-copy {
      font-family: var(--ff-c);
      font-size: .73rem;
      letter-spacing: .1em;
      color: var(--gray2);
      line-height: 1.9
    }

    .ft-copy a {
      color: var(--gray);
      text-decoration: none
    }

    /* Modal Yape */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, .92);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 200;
      opacity: 0;
      pointer-events: none;
      transition: opacity .25s
    }

    .modal-overlay.open {
      opacity: 1;
      pointer-events: all
    }

    .modal-card {
      width: calc(100% - 2.4rem);
      max-width: 310px;
      background: var(--card);
      border: 1px solid rgba(212, 160, 23, .3);
      padding: 1.8rem;
      position: relative;
      text-align: center;
      animation: cardIn .3s ease
    }

    .m-close {
      position: absolute;
      top: .7rem;
      right: .7rem;
      background: none;
      border: none;
      color: var(--gray);
      font-size: 1.3rem;
      cursor: pointer
    }

    .m-title {
      font-family: var(--ff-h);
      font-size: 2rem;
      color: var(--gold);
      margin-bottom: .4rem
    }

    .m-sub {
      font-family: var(--ff-c);
      color: var(--gray);
      font-size: .87rem;
      margin-bottom: 1.1rem
    }

    .m-qr {
      width: 145px;
      border: 3px solid var(--green);
      border-radius: 3px;
      margin-bottom: .8rem
    }

    .m-num {
      font-family: var(--ff-h);
      font-size: 1.7rem;
      color: var(--white);
      margin-bottom: 1.1rem
    }

    /* RESPONSIVE */
    @media(min-width:600px) {
      #p1 {
        padding: 4rem 2rem 5rem
      }

      .hero-logo {
        width: 150px;
        height: 150px
      }

      .hero-h {
        font-size: 5rem
      }
    }

    @media(min-width:900px) {
      #p3 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        max-width: 860px;
        align-items: start
      }

      #p3 .eco-sec:nth-child(1) {
        grid-column: 1
      }

      #p3 .eco-sec:nth-child(2) {
        grid-column: 2
      }

      #p3 .ft-block {
        grid-column: 1/-1
      }
    }

    @media(min-width:1100px) {
      #p1 {
        flex-direction: row;
        justify-content: center;
        gap: 5rem;
        text-align: left;
        max-width: 1000px;
        margin: 0 auto
      }

      #p1 .hero-logo {
        order: -1;
        width: 180px;
        height: 180px
      }

      #p1 .sbox {
        max-width: 400px
      }

      .hero-h {
        font-size: 5.5rem
      }

      .divider-rg,
      .hero-sub {
        margin-left: 0
      }
    }
  </style>
</head>

<body>

  <!-- TOPBAR -->
  <header class="topbar">
    <div class="tl">
      <!-- Logo en frontend/logo.png ‚Üí sirve como /static/img/logo.png -->
      <img src="/static/img/logo.png" alt="JR Stars"
        onerror="this.style.display='none';this.parentElement.textContent='‚≠ê'">
    </div>
    <div class="tn">JR <span>STARS</span></div>
  </header>

  <!-- PANEL 1: B√öSQUEDA -->
  <section id="p1">
    <img src="/static/img/logo.png" alt="JR Stars" class="hero-logo" onerror="this.style.display='none'">

    <div class="divider-rg"></div>
    <h1 class="hero-h">INGRESA DNI<br><span>DEL ATLETA</span></h1>
    <p class="hero-sub">// Academia JR Stars ¬∑ Cajamarca</p>

    <div class="sbox">
      <input type="tel" id="dni" class="dni-in" placeholder="76543210" maxlength="8" inputmode="numeric"
        autocomplete="off">
      <button id="btnC" class="btn-cta" onclick="buscar()">‚öΩ CONSULTAR ESTATUS</button>
      <div id="ld" class="ld-row hidden">
        <div class="sp"></div><span>Extrayendo datos...</span>
      </div>
      <div id="err" class="err-card hidden">
        <div class="err-tag">// resultado</div>
        <div class="err-h">ATLETA NO<br>REGISTRADO.</div>
        <p class="err-p">¬øTu hijo tiene el nivel para el ranking de JR Stars? Las vacantes son limitadas.</p>
        <a href="https://wa.me/51955515693?text=Hola,%20busco%20una%20prueba%20de%20nivel%20para%20mi%20hijo%20en%20JR%20Stars"
          target="_blank" class="btn-wa">üí¨ POSTULAR A LA ACADEMIA</a>
      </div>
    </div>
  </section>

  <!-- PANEL 2: FICHA FUT -->
  <section id="p2" class="hidden">
    <button class="back-btn" onclick="volver()">‚Üê NUEVA CONSULTA</button>
    <div id="card-wrap"></div>
  </section>

  <!-- PANEL 3: ECOSISTEMA -->
  <section id="p3" class="hidden">

    <div class="eco-sec">
      <span class="eco-tag">// Nutrici√≥n post-entreno</span>
      <h2 class="eco-h">KIOSKO <span>JR</span></h2>
      <div class="k-card">
        <div class="k-energy">
          <div class="k-energy-lbl"><span>üîã MONITOREO DE ENERG√çA</span><span>25% ‚Äî BAJO</span></div>
          <div class="k-bar">
            <div class="k-fill"></div>
          </div>
        </div>
        <div class="k-body">
          <span class="k-lbl">Saldo actual</span>
          <div class="k-bal">0 CR√âDITOS</div>
          <p class="k-desc">Desgaste f√≠sico detectado tras las √∫ltimas sesiones. Asegura la recuperaci√≥n muscular.</p>
          <button class="btn-rec" onclick="document.getElementById('modal-yape').classList.add('open')">
            ‚ö° RECARGAR 4 CR√âDITOS (S/20)
          </button>
        </div>
      </div>
    </div>

    <div class="eco-sec">
      <span class="eco-tag">// √âlite de disciplina</span>
      <h2 class="eco-h">TOP 5 <span>DE HIERRO</span></h2>
      <div class="rk-card">
        <div class="rk-head">
          <div class="rk-title">üèÜ ESTE MES</div>
          <div class="rk-sub">Atletas con mayor racha activa de asistencia</div>
        </div>
        <div id="ranking"></div>
      </div>
      <div class="ft-block">
        <div class="ft-links">
          <a href="https://maps.google.com/maps?q=cajamarca+peru" target="_blank">üìç Cajamarca, Per√∫</a>
          <a href="https://facebook.com" target="_blank">üìò Facebook</a>
          <a href="https://instagram.com" target="_blank">üì∏ Instagram</a>
        </div>
        <div class="ft-copy">
          JR Stars Academia ¬© 2026 &nbsp;¬∑&nbsp; <a href="tel:+51955515693">955 515 693</a>
          <br><a href="/admin/login">Administrador</a>
        </div>
      </div>
    </div>

  </section>

  <!-- MODAL YAPE -->
  <div id="modal-yape" class="modal-overlay">
    <div class="modal-card">
      <button class="m-close" onclick="document.getElementById('modal-yape').classList.remove('open')">‚úï</button>
      <div class="m-title">YAPE / PLIN</div>
      <p class="m-sub">Escanea el QR y env√≠a tu comprobante por WhatsApp.</p>
      <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=955515693&color=0a0a0a&bgcolor=D4A017"
        alt="QR Yape" class="m-qr">
      <div class="m-num">955 515 693</div>
      <a href="https://wa.me/51955515693?text=Yap√©%20S/20%20para%20cr√©ditos%20de%20kiosko%20de%20mi%20hijo."
        target="_blank" class="btn-wa">üì≤ ENVIAR COMPROBANTE</a>
    </div>
  </div>

  <script>
    const $ = id => document.getElementById(id);
    const p1 = $('p1'), p2 = $('p2'), p3 = $('p3');

    document.addEventListener('DOMContentLoaded', loadRanking);
    $('dni').addEventListener('keypress', e => { if (e.key === 'Enter') buscar(); });

    /* ‚îÄ‚îÄ CONSULTAR DNI ‚îÄ‚îÄ */
    async function buscar() {
      const dni = $('dni').value.trim();
      const btn = $('btnC');
      $('err').classList.add('hidden');

      if (!/^\d{8}$/.test(dni)) {
        $('dni').style.borderBottomColor = 'var(--red)';
        setTimeout(() => $('dni').style.borderBottomColor = 'var(--gold)', 900);
        return;
      }

      btn.disabled = true;
      $('ld').classList.remove('hidden');

      try {
        const res = await fetch(`/public/student/${dni}/info`);

        if (res.status === 404) {
          $('ld').classList.add('hidden');
          btn.disabled = false;
          $('err').classList.remove('hidden');
          $('err').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          return;
        }

        if (!res.ok) throw new Error('server');

        const data = await res.json();
        $('ld').classList.add('hidden');
        btn.disabled = false;

        setTimeout(() => {
          renderCard(data);
          p1.classList.add('hidden');
          p2.classList.remove('hidden');
          p3.classList.remove('hidden');
          $('dni').value = '';
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }, 250);

      } catch {
        $('ld').classList.add('hidden');
        btn.disabled = false;
        alert('Error de conexi√≥n. Verifica tu internet.');
      }
    }

    /* ‚îÄ‚îÄ VOLVER ‚îÄ‚îÄ */
    function volver() {
      p2.classList.add('hidden');
      p3.classList.add('hidden');
      p1.classList.remove('hidden');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    /* ‚îÄ‚îÄ RENDER FICHA ‚îÄ‚îÄ */
    function renderCard(d) {
      const wrap = $('card-wrap');
      const av = d.img_url
        ? `<img src="${d.img_url}" alt="${d.full_name}">`
        : `<span>${d.full_name.charAt(0).toUpperCase()}</span>`;

      if (d.debe) {
        wrap.innerHTML = `
      <div class="fut-card deuda">
        <div class="card-stripe"></div>
        <div class="c-header">
          <div class="avatar">${av}</div>
          <div>
            <div class="c-name">${d.full_name}</div>
            <div class="c-cat">${d.category}</div>
          </div>
        </div>
        <div class="deuda-overlay">
          <div class="lock-ico">üîí</div>
          <div class="deuda-h">ESTATUS OCULTO</div>
          <div class="deuda-sub">MENSUALIDAD PENDIENTE</div>
          <p class="deuda-desc">
            El historial de <strong>${d.full_name.split(' ')[0]}</strong>
            est√° bloqueado. Regulariza el pago para ver tus m√©tricas.
          </p>
          <button class="btn-pagar"
                  onclick="document.getElementById('modal-yape').classList.add('open')">
            PAGAR S/80 V√çA YAPE / PLIN
          </button>
        </div>
      </div>`;
      } else {
        const waMsg = encodeURIComponent(
          `¬°Mi hijo/a ${d.full_name} tiene ${d.racha} sesiones en JR Stars! üî•üèÜ\n` +
          `Consulta el tuyo ‚Üí https://emblema-app.up.railway.app`
        );

        const histRows = (d.historial_biometrico || []).map(h => `
      <tr>
        <td class="fecha">${h.fecha}</td>
        <td>${h.talla}</td>
        <td>${h.peso}</td>
      </tr>`).join('');

        const histSection = histRows ? `
      <div class="bio-hist">
        <div class="hist-title">// EVOLUCI√ìN F√çSICA</div>
        <table class="hist-table">
          <thead><tr><th>Mes</th><th>Talla</th><th>Peso</th></tr></thead>
          <tbody>${histRows}</tbody>
        </table>
      </div>` : '';

        wrap.innerHTML = `
      <div class="fut-card ok">
        <div class="card-stripe"></div>
        <div class="c-header">
          <div class="avatar">${av}</div>
          <div>
            <div class="c-name">${d.full_name}</div>
            <div class="c-cat">${d.category}</div>
          </div>
        </div>
        <div class="racha-blk">
          <span class="racha-tag">// RACHA ACTIVA DE DISCIPLINA</span>
          <div class="racha-num"><span class="fire">üî•</span> ${d.racha} SESIONES</div>
        </div>
        ${(d.talla_actual || d.peso_actual) ? `
        <div class="bio-row">
          <div class="bio-cell">
            <div class="bio-val">${d.talla_actual || '\u2014'}<span class="bio-delta">${d.delta_talla || ''}</span></div>
            <div class="bio-label">Estatura</div>
          </div>
          <div class="bio-cell">
            <div class="bio-val">${d.peso_actual || '\u2014'}</div>
            <div class="bio-label">Peso corporal</div>
          </div>
        </div>` : `
        <div style="padding:.9rem 1.2rem;border-bottom:1px solid var(--border);font-family:var(--ff-c);font-size:.82rem;color:var(--gray);text-align:center">
          üìè Sin mediciones f√≠sicas registradas a√∫n
        </div>`}
        ${histSection}
        <div class="radar-blk">
          <div class="radar-hex"></div>
          <div class="radar-txt">
            <strong>PR√ìXIMAMENTE</strong>
            Velocidad ¬∑ Potencia ¬∑ Resistencia.
          </div>
        </div>
        <a href="https://wa.me/?text=${waMsg}" target="_blank" class="btn-presumir">
          üì≤ PRESUMIR ESTATUS
        </a>
      </div>`;
      }
    }

    /* ‚îÄ‚îÄ RANKING ‚îÄ‚îÄ */
    async function loadRanking() {
      const el = $('ranking');
      try {
        const res = await fetch('/public/leaderboard/month');
        const data = res.ok ? await res.json() : [];
        if (!data.length) {
          el.innerHTML = '<div class="rk-empty">Datos disponibles pr√≥ximamente.</div>';
          return;
        }
        el.innerHTML = data.map((item, i) => `
      <div class="rk-item${i === 0 ? ' first' : ''}">
        <div class="rk-pos">${i + 1}</div>
        <div class="rk-name">${item.name}</div>
        <div class="rk-score">üî• ${item.score}</div>
      </div>`).join('');
      } catch {
        el.innerHTML = '<div class="rk-empty" style="color:var(--red2)">No disponible.</div>';
      }
    }
  </script>
</body>

</html>