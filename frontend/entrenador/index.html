<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JR Stars ‚Äî Panel Entrenador</title>
    <link rel="stylesheet" href="/static/theme.css">
    <link rel="stylesheet" href="/static/entrenador/entrenador.css">
    <link rel="icon" href="/static/favicon-entrenador.ico" type="image/x-icon">
    <script src="https://unpkg.com/html5-qrcode"></script>
</head>

<body>

    <!-- TOPBAR -->
    <div class="topbar">
        <a href="/" class="topbar-brand">
            <div class="topbar-logo-circle">
                <img src="/static/img/logo.png" alt="logo" onload="this.classList.add('loaded')"
                    onerror="this.style.display='none';this.nextElementSibling.style.display='block'">
                <span class="logo-fallback">‚≠ê</span>
            </div>
            <span class="topbar-name">JR <span>STARS</span></span>
        </a>
        <div class="topbar-right">
            <span class="offline-badge" id="offline-badge"></span>
            <span class="topbar-role-badge">üèÉ Entrenador</span>
            <span class="topbar-email" id="coach-email"></span>
            <button class="btn btn-outline topbar-logout-btn" onclick="logout()">Salir</button>
        </div>
    </div>

    <!-- OVERLAY FLASH DE PANTALLA COMPLETA -->
    <div class="flash-overlay" id="flash-overlay">
        <div class="flash-icon" id="flash-icon"></div>
        <div class="flash-name" id="flash-name"></div>
        <div class="flash-status" id="flash-status"></div>
        <div class="flash-detalle" id="flash-detalle"></div>
        <div class="flash-bar" id="flash-bar"></div>
    </div>

    <!-- CONTENIDO PRINCIPAL -->
    <div class="coach-layout">

        <!-- ‚îÄ‚îÄ TAB: SCANNER ‚îÄ‚îÄ -->
        <div class="tab-page active" id="tab-scanner">
            <div class="page-header">
                <div class="page-title">üì∑ <span>Scanner</span></div>
                <div class="nfc-badge" id="nfc-badge">NFC</div>
            </div>

            <div class="scanner-wrap">
                <div class="scanner-box">
                    <div id="reader"></div>
                    <div class="scan-hint">Acerca el QR o medall√≥n NFC del alumno</div>
                </div>
                <div class="scan-history-panel">
                    <div class="history-title">√öLTIMOS REGISTROS</div>
                    <ul id="scan-history"></ul>
                </div>
            </div>
        </div>

        <!-- ‚îÄ‚îÄ TAB: ASISTENCIA ‚îÄ‚îÄ -->
        <div class="tab-page" id="tab-asistencia">
            <div class="page-header">
                <div class="page-title">üìã <span>Asistencia Hoy</span></div>
                <button class="btn btn-outline" onclick="loadAsistencia()">‚ü≥ Actualizar</button>
            </div>

            <div class="asistencia-stats" id="asistencia-stats"></div>

            <div class="asistencia-filtros">
                <button class="chip active" id="chip-todos" onclick="setFiltroAsist('todos', this)">Todos</button>
                <button class="chip" id="chip-presentes" onclick="setFiltroAsist('presentes', this)">‚úÖ
                    Presentes</button>
                <button class="chip" id="chip-ausentes" onclick="setFiltroAsist('ausentes', this)">‚ùå Ausentes</button>
                <button class="chip chip-rojo" id="chip-deudores" onclick="setFiltroAsist('deudores', this)">‚ö†Ô∏è
                    Deben</button>
            </div>

            <!-- Filtros de Sede y Grupo -->
            <div class="asistencia-filtros" style="margin-top:.5rem;flex-wrap:wrap;gap:.5rem">
                <select id="filtro-ent-sede" class="select-jr" style="font-size:.82rem;padding:.35rem .6rem;width:auto"
                    onchange="renderAsistencia()">
                    <option value="">Todas las sedes</option>
                    <option value="El Bosque">El Bosque</option>
                    <option value="Centro">Centro</option>
                    <option value="Norte">Norte</option>
                    <option value="Sur">Sur</option>
                </select>
                <select id="filtro-ent-grupo" class="select-jr" style="font-size:.82rem;padding:.35rem .6rem;width:auto"
                    onchange="renderAsistencia()">
                    <option value="">Todos los grupos</option>
                    <option value="A">Grupo A</option>
                    <option value="B">Grupo B</option>
                    <option value="C">Grupo C</option>
                    <option value="D">Grupo D</option>
                    <option value="E">Grupo E</option>
                </select>
                <input type="text" id="filtro-ent-nombre" class="input-jr"
                    style="font-size:.82rem;padding:.35rem .6rem;max-width:160px" placeholder="üîç Buscar nombre..."
                    oninput="renderAsistencia()">
            </div>

            <div id="asistencia-list">
                <div class="loading-msg">Cargando...</div>
            </div>
        </div>

    </div>

    <!-- NAV INFERIOR -->
    <nav class="bottom-nav">
        <button class="bnav-btn active" id="bnav-scanner" onclick="goTab('scanner', this)">
            <span>üì∑</span><span class="bnav-label">Scanner</span>
        </button>
        <button class="bnav-btn" id="bnav-asistencia" onclick="goTab('asistencia', this)">
            <span>üìã</span><span class="bnav-label">Asistencia</span>
        </button>
    </nav>

    <script src="/static/entrenador/entrenador.js"></script>
</body>

</html>